<?xml version="1.0" encoding="UTF-8"?>
<StructureDefinition xmlns="http://hl7.org/fhir">
    <id value="ch-core-patient"/>
    <url value="http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-patient"/>
    <version value="2.0.0"/>
    <name value="CHCorePatient"/>
    <title value="CH Core Patient"/>
    <status value="active"/>
    <date value="2018-10-15T00:00:00+10:00"/>
    <publisher value="HL7 Switzerland"/>
    <contact>
        <name value="HL7 Switzerland"/>
        <telecom>
            <system value="url"/>
            <value value="https://www.hl7.ch/"/>
        </telecom>
    </contact>
    <description value="Core patient definition in the swiss context. Relevant are definitions by the eCH-0010 V7.0 data standard mailing address and eCH-0011 V8.1 data standard pesond data.
The CH Core Patient is based upon the core FHIR Patient Resource and designed to meet the applicable patient demographic data elements in Switzerland. 
See also [BFS](https://www.bfs.admin.ch/bfs/de/home/register/personenregister/registerharmonisierung/nomenklaturen.html) for further information"/>
    <jurisdiction>
        <coding>
            <system value="urn:iso:std:iso:3166"/>
            <code value="CH"/>
        </coding>
    </jurisdiction>
    <purpose value="Core patient demographics which can be shared" />
    <fhirVersion value="4.0.1" />
    <mapping>
        <identity value="eCH"/>
        <uri value="http://www.ech.ch/"/>
        <name value="eCH-Standards"/>
    </mapping>
    <mapping>
        <identity value="EPR"/>
        <uri value="https://art-decor.org/art-decor/decor-valuesets--ch-epr-"/>
        <name value="EPR ValueSets"/>
    </mapping>
    <mapping>
        <identity value="v2"/>
        <uri value="http://hl7.org/v2"/>
        <name value="HL7 v2 Mapping"/>
    </mapping>
    <kind value="resource"/>
    <abstract value="false"/>
    <type value="Patient"/>
    <baseDefinition value="http://hl7.org/fhir/StructureDefinition/Patient"/>
    <derivation value="constraint"/>
    <differential>
        <element id="Patient">
            <path value="Patient"/>
            <short value="CH Core Patient"/>
            <definition value="The CH Core Patient is based upon the core FHIR Patient Resource and designed to meet the applicable patient demographic data elements in Switzerland. See also https://www.bfs.admin.ch/bfs/de/home/register/personenregister/registerharmonisierung/nomenklaturen.html for further information"/>
            <constraint>
                <key value="ch-pat-1"/>
                <severity value="error"/>
                <human value="At least one HumanName with given and family name must be provided."/>
                <expression value="name.where(family.exists() and given.exists()).count()>0 or name.empty()"/>
            </constraint>
            <constraint>
                <key value="ch-pat-2"/>
                <severity value="warning"/>
                <human value="gender unknown is currently not used in Switzerland in eCH and the EPR"/>
                <expression value="gender.empty() or gender!='unknown'"/>
            </constraint>
        </element>
        <element id="Patient.extension">
            <path value="Patient.extension" />
            <slicing>
                <discriminator>
                    <type value="value" />
                    <path value="url" />
                </discriminator>
                <rules value="open" />
            </slicing>
        </element>
        <element id="Patient.extension:placeOfBirth">
            <path value="Patient.extension" />
            <sliceName value="placeOfBirth" />
            <short value="Place of birth of patient"/>
            <min value="0"/>
            <max value="1"/>
            <type>
                <code value="Extension" />
                <profile value="http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-patient-ech-11-placeofbirth" />
            </type>
            <mapping>
                <identity value="eCH"/>
                <map value="eCH-0011: 3.3.3.2 placeOfBirth BFS-322, BFS-323, BFS 324"/>
            </mapping>
        </element>
        <element id="Patient.extension:placeOfOrigin">
            <path value="Patient.extension" />
            <sliceName value="placeOfOrigin" />
            <short value="Place of origin(s) of patient"/>
            <min value="0"/>
            <max value="*"/>
            <type>
                <code value="Extension" />
                <profile value="http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-patient-ech-11-placeoforigin" />
            </type>
            <mapping>
                <identity value="eCH"/>
                <map value="eCH-0011: 3.3.10 placeOfOrigin, BFS-42" />
            </mapping>
        </element>
        <element id="Patient.extension:citizenship">
            <path value="Patient.extension" />
            <sliceName value="citizenship" />
            <short value="Citizenship(s) of patient"/>
            <definition value="The content of the country code element (if present) SHALL be selected EITHER from ValueSet ISO Country Alpha-2 http://hl7.org/fhir/ValueSet/iso3166-1-2 OR MAY be selected from ISO Country Alpha-3 Value Set http://hl7.org/fhir/ValueSet/iso3166-1-3, if the country is not specified in value Set ISO Country Alpha-2 http://hl7.org/fhir/ValueSet/iso3166-1-2." />
            <min value="0"/>
            <max value="*"/>
            <type>
                <code value="Extension" />
                <profile value="http://hl7.org/fhir/StructureDefinition/patient-citizenship" />
            </type>
            <constraint>
                <key value="ch-pat-3"/>
                <severity value="error"/>
                <human value="ISO Country Alpha-2 or ISO Country Alpha-3 code"/>
                <expression value="((extension.where(url='code').valueCodeableConcept.coding.code.length()=2) and extension.where(url='code').valueCodeableConcept.coding.code.memberOf('http://hl7.org/fhir/ValueSet/iso3166-1-2')) or ((extension.where(url='code').valueCodeableConcept.coding.code.length() = 3) and extension.where(url='code').valueCodeableConcept.coding.code.memberOf('http://hl7.org/fhir/ValueSet/iso3166-1-3'))" />
            </constraint>
            <mapping>
                <identity value="eCH"/>
                <map value="eCH-0011: 3.3.6 nationalityData"/>
            </mapping>
        </element>
        <element id="Patient.extension:religion">
            <path value="Patient.extension" />
            <sliceName value="religion" />
            <short value="Religion of patient"/>
            <min value="0"/>
            <max value="1"/>
            <type>
                <code value="Extension" />
                <profile value="http://hl7.org/fhir/StructureDefinition/patient-religion" />
            </type>
            <mapping>
                <identity value="eCH"/>
                <map value="eCH-0011: 3.3.4.1 religion, BFS-711" />
            </mapping>
        </element>

        <element id="Patient.identifier">
            <path value="Patient.identifier" />
            <slicing>
                <discriminator>
                    <type value="pattern" />
                    <path value="$this" />
                </discriminator>
                <rules value="open" />
            </slicing>
        </element>
        <element id="Patient.identifier.system">
            <path value="Patient.identifier.system" />
            <min value="1" />
        </element>
        <element id="Patient.identifier.value">
            <path value="Patient.identifier.value" />
            <min value="1" />
        </element>
        <!-- Slice EPR-SPID -->
        <element id="Patient.identifier:EPR-SPID">
            <path value="Patient.identifier" />
            <sliceName value="EPR-SPID" />
            <short value="EPR-SPID" />
            <definition value="EPR-SPID: The Central Compensation Office (ZAS; CCO) assigns and manages the new patient identification number according to the EPRA (EPR-SPID), which is only linked internally in the CCO with the AHV number. It maintains the UPI identification database (Unique Personal Identifier Database), which the EPR communities may access. The law regulates how the the EPR-SPID can be used. SR 816.111 states (Art. 10 para. 3 EPDV) that communities must ensure that the EPR-SPID number cannot be not stored in document repositories or document registries." />
            <type>
                <code value="Identifier"/>
                <profile value="http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-epr-spid-identifier"/>
            </type>
            <patternIdentifier>
                <system value="urn:oid:2.16.756.5.30.1.127.3.10.3" />
            </patternIdentifier>
        </element>
        <!-- Slice AHVN13 -->
        <element id="Patient.identifier:AHVN13">
            <path value="Patient.identifier" />
            <sliceName value="AHVN13" />
            <short value="AHVN13 / NAVS13 of the patient (13 digits starting with 756, no separation points)" />
            <definition value="The AHVN13 / NAVS13 - (abbreviation for new thirteen-digit Social Security number) - is an administrative identifier for natural persons in Switzerland. It is issued, announced and administered by the Central Compensation Office. It is available to all organisations and communities for which there is a legal basis." />
            <type>
                <code value="Identifier"/>
                <profile value="http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-ahvn13-identifier"/>
            </type>
            <patternIdentifier>
                <system value="urn:oid:2.16.756.5.32" />
            </patternIdentifier>
        </element>
        <!-- Slice LocalPid -->
        <element id="Patient.identifier:LocalPid">
            <path value="Patient.identifier" />
            <sliceName value="LocalPid" />
            <short value="Local patient identifier(s)" />
            <min value="0" />
            <max value="*" />
            <patternIdentifier>
                <type>
                    <coding>
                        <system value="http://terminology.hl7.org/CodeSystem/v2-0203" />
                        <code value="MR" />
                    </coding>
                </type>
            </patternIdentifier>
        </element>
        <!-- Slice insuranceCardNumber (VEKA) -->
        <element id="Patient.identifier:insuranceCardNumber">
            <path value="Patient.identifier"/>
            <sliceName value="insuranceCardNumber"/>
            <short value="Insurance card number of the patient (20 digits)"/>
            <definition value="Cardnumber Swiss insurance card v1" />
            <type>
                <code value="Identifier"/>
                <profile value="http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-veka-identifier"/>
            </type>
            <patternIdentifier>
                <system value="urn:oid:2.16.756.5.30.1.123.100.1.1.1" />
            </patternIdentifier>
        </element>

        <element id="Patient.name">
            <path value="Patient.name"/>
            <type>
                <code value="HumanName"/>
                <profile value="http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-humanname" />
            </type>
            <mapping>
                <identity value="eCH"/>
                <map value="eCH-0011: 3.3.2 nameData"/>
            </mapping>
        </element>

        <element id="Patient.telecom">
            <path value="Patient.telecom" />
            <slicing>
                <discriminator>
                    <type value="value" />
                    <path value="system" />
                </discriminator>
                <rules value="open"/>
            </slicing>
            <mapping>
                <identity value="v2"/>
                <map value="-> as of HL7 v2.7 PID-40 (leave PID-13 and PID-14 empty)"/>
            </mapping>
            <mapping>
                <identity value="eCH"/>
                <map value="eCH-0046: Contact"/>
            </mapping>
        </element>
        <element id="Patient.telecom.system">
            <path value="Patient.telecom.system" />
            <min value="1"/>
        </element>
        <element id="Patient.telecom.value">
            <path value="Patient.telecom.value" />
            <min value="1"/>
        </element>
        <element id="Patient.telecom:email">
            <path value="Patient.telecom"/>
            <sliceName value="email"/>
            <type>
                <code value="ContactPoint"/>
                <profile value="http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-contactpoint-ech-46-email"/>
            </type>
            <mapping>
                <identity value="eCH"/>
                <map value="eCH-0046: 4.3 email"/>
            </mapping>
        </element>
        <element id="Patient.telecom:phone">
            <path value="Patient.telecom"/>
            <sliceName value="phone"/>
            <type>
                <code value="ContactPoint"/>
                <profile value="http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-contactpoint-ech-46-phone"/>
            </type>
            <mapping>
                <identity value="eCH"/>
                <map value="eCH-0046: 4.4 phone"/>
            </mapping>
        </element>
        <element id="Patient.telecom:internet">
            <path value="Patient.telecom"/>
            <sliceName value="internet"/>
            <type>
                <code value="ContactPoint"/>
                <profile value="http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-contactpoint-ech-46-internet"/>
            </type>
            <mapping>
                <identity value="eCH"/>
                <map value="eCH-0046: 4.5 internet"/>
            </mapping>
        </element>

        <element id="Patient.gender">
            <path value="Patient.gender"/>
            <short value="male | female | other"/>
            <mapping>
                <identity value="eCH"/>
                <map value="eCH-0011: 3.3.3 sex. sexType, BFS-33, see ConceptMap http://fhir.ch/ig/ch-core/ConceptMap/sex-ech11-to-fhir"/>
            </mapping>
        </element>
        <element id="Patient.birthDate">
            <path value="Patient.birthDate"/>
            <mapping>
                <identity value="eCH"/>
                <map value="eCH-0011: 3.3.3 birthData, BFS-31"/>
            </mapping>
        </element>
        <element id="Patient.deceased[x]">
            <path value="Patient.deceased[x]"/>
            <type>
                <code value="boolean"/>
            </type>
            <type>
                <code value="dateTime"/>
            </type>
            <mapping>
                <identity value="eCH"/>
                <map value="eCH-0011: 3.3.7 deathData, deathPeriod, dateFrom, BFS-361"/>
            </mapping>
        </element>
        <element id="Patient.address">
            <path value="Patient.address"/>
            <type>
                <code value="Address"/>
                <profile value="http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-address" />
            </type>
        </element>
        <element id="Patient.maritalStatus">
            <path value="Patient.maritalStatus"/>
            <binding>
                <extension url="http://hl7.org/fhir/StructureDefinition/elementdefinition-bindingName">
                    <valueString value="MaritalStatus"/>
                </extension>
                <extension url="http://hl7.org/fhir/StructureDefinition/elementdefinition-isCommonBinding">
                    <valueBoolean value="true"/>
                </extension>
                <strength value="required"/>
                <description value="The domestic partnership status of a person."/>
                <valueSet value="http://fhir.ch/ig/ch-core/ValueSet/ch-core-maritalstatus"/>
            </binding>
            <mapping>
                <identity value="eCH"/>
                <map value="eCH-0011: 3.3.5 maritalData, BFS-341, see ConceptMap http://fhir.ch/ig/ch-core/ConceptMap/maritalstatus-ech11-to-fhir"/>
            </mapping>
        </element>
        <element id="Patient.maritalStatus.extension">
            <path value="Patient.maritalStatus.extension" />
            <slicing>
                <discriminator>
                    <type value="value" />
                    <path value="url" />
                </discriminator>
                <rules value="open" />
            </slicing>
        </element>
        <element id="Patient.maritalStatus.extension:maritalDataSeparation">
            <path value="Patient.maritalStatus.extension" />
            <sliceName value="maritalDataSeparation" />
            <short value="MaritalData Separation"/>
            <min value="0"/>
            <max value="1"/>
            <type>
                <code value="Extension" />
                <profile value="http://fhir.ch/ig/ch-core/StructureDefinition/ch-ext-ech-11-maritaldata-separation" />
            </type>
            <mapping>
                <identity value="eCH"/>
                <map value="eCH-0011: 3.3.5.5 separation - Trennung BFS-343"/>
            </mapping>
        </element>

        <element id="Patient.contact">
            <path value="Patient.contact"/>
            <slicing>
                <discriminator>
                    <type value="value"/>
                    <path value="relationship"/>
                </discriminator>
                <ordered value="false"/>
                <rules value="open"/>
            </slicing>
        </element>
        <!-- slice contact -->
        <element id="Patient.contact:contact">
            <path value="Patient.contact"/>
            <sliceName value="contact"/>
            <short value="Contact data if it is not address of patient"/>
            <min value="0"/>
            <max value="1"/>
            <mapping>
                <identity value="eCH"/>
                <map value="eCH-0011: 3.3.8 contactData, BFS-61"/>
            </mapping>
        </element>
        <element id="Patient.contact.relationship:contact">
            <path value="Patient.contact.relationship"/>
            <max value="1"/>
            <patternCodeableConcept>
                <coding>
                    <system value="http://fhir.ch/ig/ch-core/CodeSystem/ech-11" />
                    <code value="contactData" />
                </coding>
            </patternCodeableConcept>
        </element>
        <element id="Patient.contact.name:contact">
            <path value="Patient.contact.name"/>
        </element>
        <element id="Patient.contact.telecom:contact">
            <path value="Patient.contact.telecom"/>
            <min value="0"/>
            <max value="0"/>
        </element>
        <element id="Patient.contact.address:contact">
            <path value="Patient.contact.address"/>
            <min value="1"/>
            <type>
                <code value="Address"/>
                <profile value="http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-address-ech-10" />
            </type>
        </element>
        <!-- slice nameOfFather -->
        <element id="Patient.contact:nameOfFather">
            <path value="Patient.contact"/>
            <sliceName value="nameOfFather"/>
            <short value="Name of father"/>
            <min value="0"/>
            <max value="1"/>
            <mapping>
                <identity value="eCH"/>
                <map value="eCH-0021: 4.1.4.1 nameOfFather"/>
            </mapping>
        </element>
        <element id="Patient.contact.relationship:nameOfFather">
            <path value="Patient.contact.relationship"/>
            <max value="1"/>
            <patternCodeableConcept>
                <coding>
                    <system value="http://terminology.hl7.org/CodeSystem/v3-RoleCode" />
                    <code value="FTH" />
                </coding>
            </patternCodeableConcept>
        </element>
        <element id="Patient.contact.name:nameOfFather">
            <path value="Patient.contact.name"/>
            <min value="1"/>
        </element>
        <!-- slice nameOfMother -->
        <element id="Patient.contact:nameOfMother">
            <path value="Patient.contact"/>
            <sliceName value="nameOfMother"/>
            <short value="Name of mother"/>
            <min value="0"/>
            <max value="1"/>
            <mapping>
                <identity value="eCH"/>
                <map value="eCH-0021: 4.1.4.2 nameOfMother"/>
            </mapping>
        </element>
        <element id="Patient.contact.relationship:nameOfMother">
            <path value="Patient.contact.relationship"/>
            <max value="1"/>
            <patternCodeableConcept>
                <coding>
                    <system value="http://terminology.hl7.org/CodeSystem/v3-RoleCode" />
                    <code value="MTH" />
                </coding>
            </patternCodeableConcept>
        </element>
        <element id="Patient.contact.name:nameOfMother">
            <path value="Patient.contact.name"/>
            <min value="1"/>
        </element>

        <element id="Patient.communication">
            <path value="Patient.communication"/>
            <slicing>
                <discriminator>
                    <type value="value"/>
                    <path value="preferred"/>
                </discriminator>
                <ordered value="false"/>
                <rules value="open"/>
            </slicing>
        </element>
        <!-- slice language of correspondence -->
        <element id="Patient.communication:languageOfCorrespondence">
            <path value="Patient.communication"/>
            <sliceName value="languageOfCorrespondence"/>
            <short value="Language of correspondence"/>
            <min value="0"/>
            <max value="1"/>
            <mapping>
                <identity value="eCH"/>
                <map value="eCH-0011: 3.3.9 languageOfCorrespondance: de, fr, it, rm = Rhaeto-Romance, en, other languages ISO 639-1"/>
            </mapping>
        </element>
        <element id="Patient.communication.language:languageOfCorrespondence">
            <path value="Patient.communication.language"/>
        </element>
        <element id="Patient.communication.preferred:languageOfCorrespondence">
            <path value="Patient.communication.preferred"/>
            <min value="1"/>
            <fixedBoolean value="true" />
        </element>
    </differential>
</StructureDefinition>